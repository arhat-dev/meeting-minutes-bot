package publisher

import (
	"context"

	"arhat.dev/meeting-minutes-bot/pkg/message"
)

type Input struct {
	// From is the name of the generator or publisher
	From string

	// Data generated by the generator or publisher
	Data []byte
}

type Interface interface {
	Name() string

	RequireLogin() bool

	// Login to platform
	Login(config UserConfig) (token string, _ error)

	// AuthURL return a one click url for external authorization
	AuthURL() (string, error)

	// Retrieve post and cache it locally according to the url
	Retrieve(url string) ([]message.Entity, error)

	// Publish a new post
	Publish(title string, body []byte) ([]message.Entity, error)

	// List all posts for this user
	List() ([]PostInfo, error)

	// Delete one post according to the url
	Delete(urls ...string) error

	// Append content to local post cache
	Append(ctx context.Context, body []byte) ([]message.Entity, error)
}

type PostInfo struct {
	Title string
	URL   string
}

type UserConfig interface {
	SetAuthToken(token string)
}
